<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>INApreliminary - Analysis of the role of individual nodes in sampling epidemic spread v6</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.co { font-style: italic; } /* Comment */
code > span.al { font-weight: bold; } /* Alert */
code > span.er { font-weight: bold; } /* Error */
code > span.wa { font-style: italic; } /* Warning */
code > span.cf { font-weight: bold; } /* ControlFlow */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.do { font-style: italic; } /* Documentation */
code > span.an { font-style: italic; } /* Annotation */
code > span.cv { font-style: italic; } /* CommentVar */
code > span.in { font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CC2.1 R Workshop</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Welcome</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Introduction to R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="CC2.1_IntroToR.html">Introduction to R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Networks in R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Describing_Networks.html">Networks in R</a>
    </li>
    <li>
      <a href="EpidemicNetworks.html">Epidemic Networks</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    RTB Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="seedHealth.html">seedHealth</a>
    </li>
    <li>
      <a href="INA.html">INA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Resources.html">Resources</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">INApreliminary - Analysis of the role of individual nodes in sampling epidemic spread v6</h1>

</div>


<p>K. A. Garrett, University of Florida</p>
<div id="impact-network-analysis" class="section level2">
<h2>Impact network analysis</h2>
<p>Impact network analysis (INA) is designed to address multiple aspects of linked socioeconomic networks (spread of ideas, money, influence, etc.) and biophysical networks (spread of new varieties, certified seed, pathogens, pests, etc.).</p>
<p>The functions introduced here are part of an R package under development, “INA”. INA is the analysis of how technologies affect regional outcomes, such as productivity or disease incidence, through their effects on linked socioeconomic and biophysical networks (Garrett 2018).</p>
<p>Garrett KA, 2018. Impact network analysis: evaluating the success of interventions. PeerJ Preprints 6, e27037v1 <a href="https://doi.org/10.7287/peerj.preprints.v1" class="uri">https://doi.org/10.7287/peerj.preprints.v1</a>.</p>
</div>
<div id="risk-based-surveillance-strategies-as-part-of-an-impact-network-analysis" class="section level2">
<h2>Risk-based surveillance strategies, as part of an impact network analysis</h2>
<p>The example given here addresses identifying the best locations in a network for sampling to quickly detect a spreading pathogen (or spreading new variety, for example). A node is better for sampling if the pathogen is likely to be detected at that node before the pathogen has spread very far through the network. For example, an isolated node would be a poor sampling choice because the pathogen could spread widely before it reaches the isolated node.</p>
<p>The functions for this analysis can also take into account information about where the pathogen is more likely to enter the network. For example, nodes with little information available through communication networks may be more likely to be vulnerable to being entry points for pathogens.</p>
</div>
<div id="getting-the-inapreliminary-package-from-github" class="section level1">
<h1>Getting the INApreliminary package from GitHub</h1>
<p>An updated version of INApreliminary will be available on GitHub soon, and a complete version with multiple types of scenario analyses will be available later this year.</p>
<p>The examples below include creation of the functions that will later be available as part of INApreliminary.</p>
<div id="a-simple-example" class="section level2">
<h2>A simple example</h2>
<p>Consider a simple adjacency matrix, which will be used to illustrate the functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;igraph&#39;</span>)
Amat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">4</span>,<span class="dt">ncol=</span><span class="dv">4</span>)
Amati &lt;-<span class="st"> </span><span class="kw">graph.adjacency</span>(Amat)
<span class="kw">plot</span>(Amati)</code></pre></div>
<p><img src="INA_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sAmat &lt;-<span class="st"> </span>Amat <span class="op">*</span><span class="st"> </span><span class="fl">0.7</span> <span class="co"># each potential link has probability 0.7 of existing - this will sometimes be useful</span></code></pre></div>
</div>
<div id="illustration" class="section level2">
<h2>Illustration</h2>
<p>For a single selected starting node, the invdetf function yields a vector of the number of nodes invaded for each sampling node by the time invasion reaches (is detected at) that sampling node, and the time step of first invasion at the sampling node - for one simulation.</p>
<p>The following code creates the function invdetf.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">invdetf &lt;-<span class="st"> </span><span class="cf">function</span>(adjmat, start.choice, <span class="dt">stoch=</span>F){

  ### for all three functions, need to add in the definitions for the input variables...
  
  dimL &lt;-<span class="st"> </span><span class="kw">dim</span>(adjmat)[<span class="dv">1</span>] <span class="co"># number of rows of adjacency matrix</span>
  t1 &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="dv">0</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>dimL, <span class="dt">nrow=</span><span class="dv">1</span>)
  t1[,start.choice] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># starting node labelled 1</span>
  
  <span class="co"># if a stochastic model, generate the adjacency matrix for this simulation</span>
    <span class="co"># if stochastic, assumes the adjacency matrix is made up of probabilities</span>

  <span class="cf">if</span>(stoch){ <span class="co"># need to think about the temporal resolution of stochasticity...</span>
    adjmat &lt;-<span class="st"> </span>(<span class="kw">matrix</span>(<span class="kw">runif</span>(dimL<span class="op">^</span><span class="dv">2</span>), <span class="dt">ncol=</span>dimL) <span class="op">&lt;</span><span class="st"> </span>adjmat)
  }

  <span class="co"># generate the infection status for each node at each time point until spread stops</span>

  outmat &lt;-<span class="st"> </span>t1
  infcount.pre &lt;-<span class="st"> </span><span class="dv">1</span>
  infcount.post &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">9</span> <span class="co"># perhaps improve structure</span>

  <span class="cf">while</span>(<span class="kw">sum</span>(t1) <span class="op">&lt;</span><span class="st"> </span>dimL <span class="op">&amp;</span><span class="st"> </span>infcount.pre <span class="op">!=</span><span class="st"> </span>infcount.post){
    infcount.pre &lt;-<span class="st"> </span><span class="kw">sum</span>(t1) <span class="co"># perhaps change to infcount.pre &lt;- infcount.post</span>
    t1 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(t1 <span class="op">%*%</span><span class="st"> </span>adjmat <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
    infcount.post &lt;-<span class="st"> </span><span class="kw">sum</span>(t1)
    outmat &lt;-<span class="st"> </span><span class="kw">rbind</span>(outmat,t1) <span class="co"># row i is the ith time point</span>
  }

  <span class="co"># find the num infected for each single sampling node, </span>
     <span class="co"># assuming infected node stays infected...</span>
    <span class="co"># consider whether to set diag...</span>

  <span class="co"># find the number of nodes infected at each time</span>
  inft &lt;-<span class="st"> </span><span class="kw">rowSums</span>(outmat)

  <span class="co"># find the first time each node is invaded, and number of nodes infected at that time</span>
  firstt &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">99</span> <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">*</span><span class="dv">1</span><span class="op">:</span>dimL <span class="co"># first time each node is invaded</span>
  numt &lt;-<span class="st"> </span>firstt <span class="co"># number of nodes infected at that time</span>

  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>dimL){ <span class="co"># col i is the ith sample node</span>

    <span class="cf">if</span> (<span class="kw">sum</span>(outmat[,i] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)){ <span class="co"># if node i ever gets infected</span>
      firstt[i] &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(outmat[,i] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)) <span class="co"># first time</span>
      numt[i] &lt;-<span class="st"> </span>inft[firstt[i]] <span class="co"># how many nodes at that time</span>
    }
    <span class="cf">else</span> {
      firstt[i] &lt;-<span class="st"> </span><span class="ot">Inf</span>
      numt[i] &lt;-<span class="st"> </span><span class="kw">max</span>(inft)
    }

  }

  <span class="co"># for each node, time first invaded and number of nodes infected at that time</span>
  sampnode &lt;-<span class="st"> </span><span class="kw">cbind</span>(firstt, numt)

  <span class="kw">list</span>(<span class="dt">outmat=</span>outmat, <span class="dt">sampnode=</span>sampnode)
}</code></pre></div>
<p>The output is two matrices. The first matrix gives the infection status for each node (column) at each time point (row) until there is no further spread. The second matrix gives, for each node (row), the time until infection (column 1) and the number of nodes infected when at that time (column 2).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">invdetf</span>(<span class="dt">adjmat=</span>Amat, <span class="dt">start.choice=</span><span class="dv">2</span>) <span class="co"># in this case, the second node was selected as the starting point</span></code></pre></div>
<pre><code>## $outmat
##    [,1] [,2] [,3] [,4]
##       0    1    0    0
## t1    0    1    1    1
## t1    0    1    1    1
## 
## $sampnode
##      firstt numt
## [1,]    Inf    3
## [2,]      1    1
## [3,]      2    3
## [4,]      2    3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">invdetf</span>(<span class="dt">adjmat=</span>sAmat, <span class="dt">start.choice=</span><span class="dv">2</span>,<span class="dt">stoch=</span>T) <span class="co"># stochastic version</span></code></pre></div>
<pre><code>## $outmat
##    [,1] [,2] [,3] [,4]
##       0    1    0    0
## t1    0    0    1    0
## 
## $sampnode
##      firstt numt
## [1,]    Inf    1
## [2,]      1    1
## [3,]      2    1
## [4,]    Inf    1</code></pre>
<p>The function allstartf summarizes this analysis across all potential starting points. The following code creates allstartf.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">allstartf &lt;-<span class="st"> </span><span class="cf">function</span>(adjmat2, <span class="dt">stoch2=</span>F){

  dimL &lt;-<span class="st"> </span><span class="kw">dim</span>(adjmat2)[<span class="dv">1</span>]

  alloutmat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="op">-</span><span class="dv">99</span>, <span class="dt">ncol=</span>dimL, <span class="dt">nrow=</span>dimL)

  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>dimL) {
    alloutmat[i,] &lt;-<span class="st"> </span><span class="kw">invdetf</span>(<span class="dt">adjmat=</span>adjmat2, <span class="dt">start.choice=</span>i, <span class="dt">stoch=</span>stoch2)<span class="op">$</span>sampnode[,<span class="dv">2</span>]
  }

alloutmat
}</code></pre></div>
<p>The output is a matrix with entries being the number of nodes infected by the time an invasion is detected at each potential sampling node. Rows in this matrix are potential introduction nodes and columns are potential sampling nodes. For the stochastic case, the result is based on only one simulation (at this point in the analysis).</p>
<p>Note that the diagonal contains ones, because when a node is both the starting point and the sampling point, the epidemic will only have reached one node before detection.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">allstartf</span>(<span class="dt">adjmat2=</span>Amat)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    3    4    3
## [2,]    3    1    3    3
## [3,]    2    2    1    2
## [4,]    1    1    1    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">allstartf</span>(<span class="dt">adjmat2=</span>sAmat, <span class="dt">stoch2=</span>T)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    3    4    3
## [2,]    3    1    3    3
## [3,]    2    2    1    2
## [4,]    1    1    1    1</code></pre>
<p>The function multisimf performs the same analysis, for the specified number of simulations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">multisimf &lt;-<span class="st"> </span><span class="cf">function</span>(adjmat3, <span class="dt">stoch3=</span>F, <span class="dt">nsim=</span><span class="dv">1</span>) {

  dimL &lt;-<span class="st"> </span><span class="kw">dim</span>(adjmat3)[<span class="dv">1</span>]

  outarr &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="op">-</span><span class="dv">99</span>, <span class="kw">c</span>(dimL,dimL,nsim)) <span class="co"># all results</span>
  meanarr &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="op">-</span><span class="dv">99</span>, <span class="dt">ncol=</span>dimL, <span class="dt">nrow=</span>dimL) <span class="co"># mean of results</span>
  vararr &lt;-<span class="st"> </span>meanarr <span class="co"># variance of results</span>

  <span class="cf">for</span> (i3 <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim){
    tempout &lt;-<span class="st"> </span><span class="kw">allstartf</span>(<span class="dt">adjmat2=</span>adjmat3,<span class="dt">stoch2=</span>stoch3)
    outarr[,,i3] &lt;-<span class="st"> </span>tempout
  }

  <span class="cf">for</span> (i3 <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>dimL) {
    <span class="cf">for</span> (i4 <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>dimL) {
      meanarr[i3,i4] &lt;-<span class="st"> </span><span class="kw">mean</span>(outarr[i3,i4,])
      vararr[i3,i4] &lt;-<span class="st"> </span><span class="kw">var</span>(outarr[i3,i4,])
  } }
<span class="co"># consider potential use of apply to replace the second loop</span>

  <span class="kw">list</span>(<span class="dt">outarr=</span>outarr, <span class="dt">meanarr=</span>meanarr, <span class="dt">vararr=</span>vararr)
}</code></pre></div>
<p>The first component of the output from multisimf is the response for each simulation - nsim outputs from allstartf (in this example, 10 simulations). The next component of the output is the mean across the simulations. The final component is the variance across simulations.</p>
<p>Because columns represent potential sampling nodes, the mean of a column (in the second component of the output) is the mean number of nodes invaded by the time the invasion would be detected at that node. The mean of the variance in a column (in the third component of the output) indicates how consistently the mean number of nodes would have been invaded.</p>
<p>(AN OPTION NOT TO SHOW ALL SIMULATION RESULTS WILL BE INCLUDED)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">multisimf</span>(<span class="dt">adjmat3=</span>sAmat, <span class="dt">stoch=</span>T, <span class="dt">nsim=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## $outarr
## , , 1
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    3    4    3
## [2,]    3    1    2    3
## [3,]    2    2    1    2
## [4,]    1    1    1    1
## 
## , , 2
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    3    4    3
## [2,]    2    1    2    2
## [3,]    2    2    1    2
## [4,]    1    1    1    1
## 
## , , 3
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    2    1    2    2
## [3,]    2    2    1    2
## [4,]    1    1    1    1
## 
## , , 4
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    2
## [2,]    2    1    2    2
## [3,]    2    2    1    2
## [4,]    1    1    1    1
## 
## , , 5
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    3    4    3
## [2,]    3    1    2    3
## [3,]    1    1    1    1
## [4,]    1    1    1    1
## 
## , , 6
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    2    2    2
## [2,]    3    1    3    3
## [3,]    2    2    1    2
## [4,]    1    1    1    1
## 
## , , 7
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    1    1    1
## [2,]    3    1    3    3
## [3,]    1    1    1    1
## [4,]    1    1    1    1
## 
## , , 8
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    3    4    3
## [2,]    1    1    1    1
## [3,]    2    2    1    2
## [4,]    1    1    1    1
## 
## , , 9
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    2    4    4
## [2,]    3    1    3    3
## [3,]    1    1    1    1
## [4,]    1    1    1    1
## 
## , , 10
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    3    3    3
## [2,]    3    1    3    3
## [3,]    2    2    1    2
## [4,]    1    1    1    1
## 
## 
## $meanarr
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  2.4  3.2  2.8
## [2,]  2.5  1.0  2.3  2.5
## [3,]  1.7  1.7  1.0  1.7
## [4,]  1.0  1.0  1.0  1.0
## 
## $vararr
##           [,1]      [,2]      [,3]      [,4]
## [1,] 0.0000000 0.4888889 1.0666667 0.8444444
## [2,] 0.5000000 0.0000000 0.4555556 0.5000000
## [3,] 0.2333333 0.2333333 0.0000000 0.2333333
## [4,] 0.0000000 0.0000000 0.0000000 0.0000000</code></pre>
</div>
<div id="weighted-likelihood-of-a-node-being-an-entry-point-into-network" class="section level2">
<h2>Weighted likelihood of a node being an entry point into network</h2>
<p>The calculations of means up to this point have been based on the assumption that each node is equally likely to be the starting node. (Alternative functions, under preparation, do include the option for nodes to have different probabilities of invasive establishment - with suffix wt)</p>
<p>The function wtsimf uses output from multisimf to evaluate the mean number of nodes reached when invasion would be detected at each potential sampling node, where potential starting nodes may have different probabilities of functioning as starting nodes. For example, higher risk of being the starting node might result from a node’s role as a port, or weather conditions associated with a node.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wtsimf &lt;-<span class="st"> </span><span class="cf">function</span>(msf.out, adjmat5, wtvec, <span class="dt">nodenam=</span><span class="ot">NA</span>) {

  dimL &lt;-<span class="st"> </span><span class="kw">dim</span>(adjmat5)[<span class="dv">1</span>]

  matop &lt;-<span class="st"> </span>msf.out<span class="op">$</span>meanarr
  wtarr &lt;-<span class="st"> </span>wtvec <span class="op">*</span><span class="st"> </span>matop

  <span class="co"># find failure rate for each sampling node</span>
  sampfail &lt;-<span class="st"> </span><span class="kw">colSums</span>(wtarr)
  tsampfail &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dv">1</span><span class="op">:</span>dimL, sampfail, nodenam)
  
  <span class="kw">list</span>(<span class="dt">wtarr=</span>wtarr, <span class="dt">tsampfail=</span>tsampfail)
}</code></pre></div>
<p>This gives the failure rate. Sometimes a more useful summary might be expressing this in terms of success rates, in the sense of the number of nodes that are not infected when the pathogen is detected by a sampling node.</p>
<p>Suppose the weights indicating the probability that each of four nodes is the introduction node are as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wtvec.ex &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.001</span>,<span class="fl">0.2</span>,<span class="fl">0.798</span>,<span class="fl">0.001</span>) <span class="co"># weights indicating the relative likelihood that each of four nodes is the introduction node for an invasion </span>

msf.outex &lt;-<span class="st"> </span><span class="kw">multisimf</span>(<span class="dt">adjmat3=</span>sAmat, <span class="dt">stoch=</span>T, <span class="dt">nsim=</span><span class="dv">10</span>)

<span class="kw">wtsimf</span>(<span class="dt">msf.out=</span>msf.outex, <span class="dt">adjmat5=</span>sAmat, <span class="dt">wtvec=</span>wtvec.ex)</code></pre></div>
<pre><code>## $wtarr
##        [,1]   [,2]   [,3]   [,4]
## [1,] 0.0010 0.0022 0.0026 0.0026
## [2,] 0.3400 0.2000 0.3400 0.3400
## [3,] 1.3566 1.3566 0.7980 1.3566
## [4,] 0.0010 0.0010 0.0010 0.0010
## 
## $tsampfail
##   X1.dimL sampfail nodenam
## 1       1   1.6986      NA
## 2       2   1.5598      NA
## 3       3   1.1416      NA
## 4       4   1.7002      NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wtsimf</span>(<span class="dt">msf.out=</span>msf.outex, <span class="dt">adjmat5=</span>sAmat, <span class="dt">wtvec=</span>wtvec.ex, <span class="dt">nodenam=</span><span class="kw">c</span>(<span class="st">&quot;KS&quot;</span>,<span class="st">&quot;NE&quot;</span>,<span class="st">&quot;ND&quot;</span>,<span class="st">&quot;SD&quot;</span>))</code></pre></div>
<pre><code>## $wtarr
##        [,1]   [,2]   [,3]   [,4]
## [1,] 0.0010 0.0022 0.0026 0.0026
## [2,] 0.3400 0.2000 0.3400 0.3400
## [3,] 1.3566 1.3566 0.7980 1.3566
## [4,] 0.0010 0.0010 0.0010 0.0010
## 
## $tsampfail
##   X1.dimL sampfail nodenam
## 1       1   1.6986      KS
## 2       2   1.5598      NE
## 3       3   1.1416      ND
## 4       4   1.7002      SD</code></pre>
<p>Using the weights based on the number of information sources, or the quality of information sources, is one way to integrate the socioeconomic network and the biophysical network, with an egocentric network focus. There are many other possibilities for linking the two networks, potentially drawing on more information about the network of information communication. An example of this analysis applied to potential spread of disease through a seed system is available in</p>
<p>Buddenhagen, C. E., J. F. Hernandez Nopsa, K. F. Andersen, J. Andrade-Piedra, G. A. Forbes, P. Kromann, S. Thomas-Sharma, P. Useche, and K. A. Garrett. 2017. Epidemic network analysis for mitigation of invasive pathogens in seed systems: Potato in Ecuador. Phytopathology 107:1209-1218.</p>
<p>Andersen KF, Buddenhagen CE, Rachkara P, Gibson R, Kalule S, Phillips D, Garrett KA, 2018. Modeling epidemics in seed systems and landscapes to guide management strategies: The case of sweetpotato in Northern Uganda. Phytopathology, <a href="https://doi.org/10.1094/PHYTO-03-18-0072-R" class="uri">https://doi.org/10.1094/PHYTO-03-18-0072-R</a></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
