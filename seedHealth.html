<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Preliminary version of seedHealth package vignette v8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.co { font-style: italic; } /* Comment */
code > span.al { font-weight: bold; } /* Alert */
code > span.er { font-weight: bold; } /* Error */
code > span.wa { font-style: italic; } /* Warning */
code > span.cf { font-weight: bold; } /* ControlFlow */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.do { font-style: italic; } /* Documentation */
code > span.an { font-style: italic; } /* Annotation */
code > span.cv { font-style: italic; } /* CommentVar */
code > span.in { font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CC2.1 R Workshop</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Welcome</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Introduction to R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="CC2.1_IntroToR.html">Introduction to R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Networks in R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Describing_Networks.html">Networks in R</a>
    </li>
    <li>
      <a href="EpidemicNetworks.html">Epidemic Networks</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    RTB Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="seedHealth.html">seedHealth</a>
    </li>
    <li>
      <a href="INA.html">INA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Resources.html">Resources</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Preliminary version of seedHealth package vignette v8</h1>

</div>


<div id="slides-for-ths-section-can-be-found-here" class="section level3">
<h3>Slides for ths section can be found here:</h3>
<ul>
<li><a href="PDFFiles/R%20packages%20seedHealth%20and%20INAprelim.pdf">seedHealth and INA</a></li>
</ul>
</div>
<div id="seedhealth-package-applications" class="section level2">
<h2>seedHealth package applications</h2>
<p>This package provides a scenario analysis for evaluating outcomes for integrated seed health strategies. It is based on and builds on the analyses and code from</p>
<p>Thomas-Sharma, S., Andrade-Piedra, J., Carvajal Yepes, M., Hernandez Nopsa, J., Jeger, M., Jones, R., Kromann, P., Legg, J., Yuen, J., Forbes, G., and Garrett, K. A. 2017. A risk assessment framework for seed degeneration: Informing an integrated seed health strategy for vegetatively-propagated crops. Phytopathology 107:1123-1135.</p>
<p>Open access link for paper: <a href="https://apsjournals.apsnet.org/doi/10.1094/PHYTO-09-16-0340-R" class="uri">https://apsjournals.apsnet.org/doi/10.1094/PHYTO-09-16-0340-R</a></p>
<p>Link for online Shiny interface for exploring the seedHealth model: <a href="https://yanru-xing.shinyapps.io/SDAppvX1/" class="uri">https://yanru-xing.shinyapps.io/SDAppvX1/</a></p>
</div>
<div id="getting-the-seedhealth-package-from-github" class="section level1">
<h1>Getting the seedHealth package from GitHub</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">repos=</span><span class="kw">structure</span>(<span class="kw">c</span>(<span class="dt">CRAN=</span><span class="st">&quot;https://cran.cnr.berkeley.edu/&quot;</span>)))
<span class="kw">library</span>(devtools)

<span class="co"># use devtools function install_github to install the seedHealth version available on GitHub</span>
<span class="co"># this is only necessary once, until a new version is available</span>
<span class="co"># uncomment the following line if you have not installed seedHealth yet, or a new version is available</span>

<span class="co">#devtools::install_github(&quot;GarrettLab/seedHealth&quot;)</span>

<span class="kw">library</span>(seedHealth)</code></pre></div>
<p>The code below uses two other R packages - these will need to be installed if they have not yet been installed. The commands for installing are commented out below, but the “#” in front of the command line can be removed to install.</p>
</div>
<div id="function-onesim" class="section level1">
<h1>Function onesim</h1>
<p>This function evaluates a time series of yield loss due to seed degeneration across seasons. Weather conduciveness to disease and other factors are included as stochastic components of the model.</p>
</div>
<div id="arguments-in-function-onesim" class="section level1">
<h1>Arguments in function onesim</h1>
<p>There are several arguments that can be modified in function onesim to describe how seed degeneration occurs over time. These arguments are described in more detail in a table in Thomas-Sharma et al. 2017.</p>
<p>pHSinit the initial proportion of healthy seed, numeric or numeric vector. Kx<br />
the total number of plants, positive interger, numeric or numeric vector. betax<br />
the maximum seasonal transmission rate, numeric or numeric vector. wxtnormm<br />
the environmental effect on transmission rate (mean of underlying normal distribution prior to truncation), numeric or numeric vector. wxtnormsd<br />
the environmental effect on transmission rate (standard deviation of underlying normal distribution prior to truncation), numeric or numeric vector. hx<br />
the host effect on transmission rate, numeric or numeric vector. mxtnormm<br />
the vector management effect on transmission rate (mean of underlying normal distribution prior to truncation), numeric or numeric vector. mxtnormsd<br />
the vector management effect on transmission rate (standard deviation of underlying normal distribution prior to truncation), numeric or numeric vector. axtnormm<br />
the roguing effect in terms of decreased DP (mean of underlying normal distribution prior to truncation), numeric or numeric vector. axtnormsd<br />
the roguing effect in terms of decreased DP (standard deviation of underlying normal distribution prior to truncation), numeric or numeric vector. rx<br />
the reversion rate, numeric or numeric vector. zxtnormm<br />
the proportional selection against diseased plants (mean of underlying normal distribution prior to truncation), numeric or numeric vector. zxtnormsd<br />
the proportional selection against diseased plants (standard deviation of underlying normal distribution prior to truncation), numeric or numeric vector. gx<br />
the seed production rate in healthy plants, numeric or numeric vector. cx<br />
the proportional seed production rate in diseased plants, numeric or numeric vector. phix<br />
the proportion clean seed purchased, numeric or numeric vector. nseasons<br />
the number of seasons, numeric or numeric vector. HPcut<br />
the proportion healthy plant number cutoff, numeric or numeric vector. pHScut<br />
the proportion healthy seed cutoff, numeric or numeric vector. maY the maximum attainable yield, end of season, in the absence of disease, numeric or numeric vector. miY the minimum yield when all plants are diseased (useable yield despite disease), numeric or numeric vector. thetax<br />
the rate of decline of Yld with increasing disease incidence, numeric or numeric vector. Ex<br />
the amount of external inoculum around field, numeric or numeric vector.</p>
<div id="example-of-plotting-seed-degeneration-effects-over-time" class="section level2">
<h2>Example of plotting seed degeneration effects over time</h2>
<p>Note that this command produces results similar to those from the online Shiny interface for seedHealth</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;RColorBrewer&quot;</span>) <span class="co"># remove the initial &#39;#&#39; if this is not yet installed</span></code></pre></div>
<pre><code>## 
## The downloaded binary packages are in
##  /var/folders/3f/wdpyyh2x0r5c5j0s55mwx8d80000gn/T//RtmpbMJelH/downloaded_packages</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RColorBrewer)

out1 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.8</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.1</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>, <span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
int1 &lt;-<span class="st"> </span>out1<span class="op">$</span>outm<span class="op">$</span>YL
seas1 &lt;-<span class="st"> </span>out1<span class="op">$</span>outm<span class="op">$</span>season

<span class="co"># nreals is the number of realizations - higher values gives a smoother plot</span>
nreals &lt;-<span class="st"> </span><span class="dv">10</span>

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nreals){ 
    out1 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.8</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.1</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>, <span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
    int1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(int1,out1<span class="op">$</span>outm<span class="op">$</span>YL)
    seas1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(seas1,out1<span class="op">$</span>outm<span class="op">$</span>season)
}

<span class="kw">smoothScatter</span>(seas1,int1, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Yield loss (%)&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">font.lab=</span><span class="dv">2</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>, <span class="dt">cex.axis=</span><span class="fl">1.25</span>, <span class="dt">nrpoints=</span><span class="dv">0</span>, <span class="dt">colramp=</span><span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&quot;Greys&quot;</span>)))
<span class="kw">lines</span>(<span class="kw">colMeans</span>(seas1), <span class="kw">colMeans</span>(int1), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="seedHealth_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Could produce a summary table</span>
<span class="co">#write.table(x=int1, file=paste(&#39;int_out1&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span></code></pre></div>
</div>
<div id="fig.-2.-from-thomas-sharma-et-al.-2017-long-term-yield-loss-under-no-management-scenarios" class="section level2">
<h2>Fig. 2. from Thomas-Sharma et al. 2017: Long-term yield loss under no management scenarios</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="fl">4.4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>))

out1 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.8</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.1</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>, <span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
int1 &lt;-<span class="st"> </span>out1<span class="op">$</span>outm<span class="op">$</span>YL
seas1 &lt;-<span class="st"> </span>out1<span class="op">$</span>outm<span class="op">$</span>season

<span class="co"># temporary note: wxd and wdsamp were removed</span>

<span class="co"># nreals is the number of realizations - higher values gives a smoother plot</span>
nreals &lt;-<span class="st"> </span><span class="dv">10</span>

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nreals){ 
    out1 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.8</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.1</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>, <span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
    int1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(int1,out1<span class="op">$</span>outm<span class="op">$</span>YL)
    seas1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(seas1,out1<span class="op">$</span>outm<span class="op">$</span>season)
}

<span class="co"># Could produce an about table</span>
<span class="co"># write.table(x=int1, file=paste(&#39;int_out1&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span>

<span class="kw">smoothScatter</span>(seas1,int1, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Yield loss (%)&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">font.lab=</span><span class="dv">2</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>, <span class="dt">cex.axis=</span><span class="fl">1.25</span>, <span class="dt">nrpoints=</span><span class="dv">0</span>, <span class="dt">colramp=</span><span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&quot;Greys&quot;</span>)))
<span class="kw">lines</span>(<span class="kw">colMeans</span>(seas1), <span class="kw">colMeans</span>(int1), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)

out2 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.8</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>,<span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
int2 &lt;-<span class="st"> </span>out2<span class="op">$</span>outm<span class="op">$</span>YL
seas2 &lt;-<span class="st"> </span>out2<span class="op">$</span>outm<span class="op">$</span>season

<span class="co"># for speed, only &quot;i in 1:10&quot;</span>

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nreals){ <span class="co"># higher values make a smoother plot</span>
    out2 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.8</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>, <span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>, <span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
    int2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(int2,out2<span class="op">$</span>outm<span class="op">$</span>YL)
    seas2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(seas2,out2<span class="op">$</span>outm<span class="op">$</span>season)
}

<span class="co">#write.table(x=int2, file=paste(&#39;int_out2&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span>

<span class="kw">smoothScatter</span>(seas2,int2, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">font.lab=</span><span class="dv">2</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>, <span class="dt">cex.axis=</span><span class="fl">1.25</span>, <span class="dt">nrpoints=</span><span class="dv">0</span>, <span class="dt">colramp=</span><span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&quot;Greys&quot;</span>)))
<span class="kw">lines</span>(<span class="kw">colMeans</span>(seas2), <span class="kw">colMeans</span>(int2), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)

out3 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.2</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.1</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>, <span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
int3 &lt;-<span class="st"> </span>out3<span class="op">$</span>outm<span class="op">$</span>YL
seas3 &lt;-<span class="st"> </span>out3<span class="op">$</span>outm<span class="op">$</span>season


<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nreals){ <span class="co"># higher values make a smoother plot</span>
    out3 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.2</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.1</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>,<span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
    int3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(int3,out3<span class="op">$</span>outm<span class="op">$</span>YL)
    seas3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(seas3,out3<span class="op">$</span>outm<span class="op">$</span>season)
}
<span class="co">#write.table(x=int3, file=paste(&#39;int_out3&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span>

<span class="kw">smoothScatter</span>(seas3,int3, <span class="dt">xlab=</span><span class="st">&#39;Number of seasons&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Yield loss (%)&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">font.lab=</span><span class="dv">2</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>, <span class="dt">cex.axis=</span><span class="fl">1.25</span>, <span class="dt">nrpoints=</span><span class="dv">0</span>, <span class="dt">colramp=</span><span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&quot;Greys&quot;</span>)))
<span class="kw">lines</span>(<span class="kw">colMeans</span>(seas3), <span class="kw">colMeans</span>(int3), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)

out4 &lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.2</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>, <span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
int4 &lt;-<span class="st"> </span>out4<span class="op">$</span>outm<span class="op">$</span>YL
seas4 &lt;-<span class="st"> </span>out4<span class="op">$</span>outm<span class="op">$</span>season

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nreals){ <span class="co"># higher values make a smoother plot</span>
    out4&lt;-<span class="st"> </span><span class="kw">onesim</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="fl">0.2</span>, <span class="dt">wxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>, <span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="dv">1</span>, <span class="dt">zxtnormsd=</span> <span class="dv">0</span>, <span class="dt">gx=</span><span class="dv">4</span>,<span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">10</span>, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>,<span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)
    int4 &lt;-<span class="st"> </span><span class="kw">rbind</span>(int4,out4<span class="op">$</span>outm<span class="op">$</span>YL)
    seas4 &lt;-<span class="st"> </span><span class="kw">rbind</span>(seas4,out4<span class="op">$</span>outm<span class="op">$</span>season)
}

<span class="co"># write.table(x=int4, file=paste(&#39;int_out4&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span>

<span class="kw">smoothScatter</span>(seas4,int4, <span class="dt">xlab=</span><span class="st">&#39;Number of seasons&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">font.lab=</span><span class="dv">2</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>, <span class="dt">cex.axis=</span><span class="fl">1.25</span>, <span class="dt">nrpoints=</span><span class="dv">0</span>, <span class="dt">colramp=</span><span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&quot;Greys&quot;</span>)))
<span class="kw">lines</span>(<span class="kw">colMeans</span>(seas4), <span class="kw">colMeans</span>(int4), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="seedHealth_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
</div>
<div id="function-multipar" class="section level1">
<h1>Function multipar</h1>
<p>This function evaluates multiple simulations for multiple parameter combinations.</p>
<div id="thomas-sharma-et-al.-2017-fig-5.-variability-in-positive-selection" class="section level2">
<h2>Thomas-Sharma et al. 2017; Fig 5. Variability in positive selection</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)

<span class="co">#Low variability in selection, low initial infection (20%) </span>

out.PS10&lt;-<span class="st"> </span><span class="kw">multipar</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>), <span class="dt">wxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>,<span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>), <span class="dt">zxtnormsd=</span> <span class="fl">0.1</span>, <span class="dt">gx=</span><span class="dv">4</span>, <span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">5</span>, <span class="dt">nsim=</span>nreals, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>, <span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)

<span class="co">#write.table(x=out.PS10, file=paste(&#39;out.PS10&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span>

xvar &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>out.PS10<span class="op">$</span>zxtnormm
yvar&lt;-<span class="st"> </span>out.PS10<span class="op">$</span>wxtnormm
zvar &lt;-<span class="st"> </span>out.PS10<span class="op">$</span>fYLmean

wlovarPSlobe20&lt;-<span class="st"> </span><span class="kw">wireframe</span>(zvar <span class="op">~</span><span class="st"> </span>xvar <span class="op">*</span><span class="st"> </span>yvar, <span class="dt">data =</span> out.PS10, <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">arrows=</span><span class="ot">FALSE</span>, <span class="dt">cex=</span> <span class="fl">1.25</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">font =</span> <span class="dv">1</span>, <span class="dt">distance=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">z =</span><span class="op">-</span><span class="dv">50</span>, <span class="dt">x =</span> <span class="op">-</span><span class="dv">75</span>), <span class="dt">xlab =</span> <span class="kw">list</span>(<span class="st">&#39;Healthy seeds </span><span class="ch">\n</span><span class="st"> selected&#39;</span>, <span class="dt">rot=</span><span class="op">-</span><span class="dv">27</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>), <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="st">&#39;Disease-conducive </span><span class="ch">\n</span><span class="st"> weather&#39;</span>, <span class="dt">rot=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>), <span class="dt">zlab =</span><span class="kw">list</span>(<span class="st">&#39;Yield loss after 5 seasons (%)&#39;</span>, <span class="dt">rot=</span><span class="dv">90</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>) , <span class="dt">zlim =</span> <span class="kw">range</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>,<span class="dv">20</span>)), <span class="dt">zoom=</span><span class="fl">0.8</span>)

<span class="co">#trellis.device(device=&#39;pdf&#39;,file=&quot;wlovarPSlobe20.pdf&quot;, paper=&#39;a4&#39;)</span>
<span class="co">#trellis.par.set(&quot;axis.line&quot;, list(col=&quot;transparent&quot;))</span>
<span class="kw">print</span>(wlovarPSlobe20)</code></pre></div>
<p><img src="seedHealth_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#dev.off()</span>

<span class="co">#High variability in selection, low initial infection (20%)  </span>

out.PS11  &lt;-<span class="st"> </span><span class="kw">multipar</span>(<span class="dt">pHSinit=</span><span class="fl">0.8</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>), <span class="dt">wxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>,<span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>), <span class="dt">zxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">gx=</span><span class="dv">4</span>, <span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">5</span>, <span class="dt">nsim=</span>nreals, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>, <span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)

<span class="co">#write.table(x=out.PS11, file=paste(&#39;out.PS11&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span>

xvar &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>out.PS11<span class="op">$</span>zxtnormm
yvar&lt;-<span class="st"> </span>out.PS11<span class="op">$</span>wxtnormm
zvar &lt;-<span class="st"> </span>out.PS11<span class="op">$</span>fYLmean

whivarPSlobe20&lt;-<span class="kw">wireframe</span>(zvar <span class="op">~</span><span class="st"> </span>xvar <span class="op">*</span><span class="st"> </span>yvar, <span class="dt">data =</span> out.PS11, <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">arrows=</span><span class="ot">FALSE</span>, <span class="dt">cex=</span> <span class="fl">1.25</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">font =</span> <span class="dv">1</span>, <span class="dt">distance=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">z =</span><span class="op">-</span><span class="dv">50</span>, <span class="dt">x =</span> <span class="op">-</span><span class="dv">75</span>), <span class="dt">xlab =</span> <span class="kw">list</span>(<span class="st">&#39;Healthy seeds </span><span class="ch">\n</span><span class="st"> selected&#39;</span>, <span class="dt">rot=</span><span class="op">-</span><span class="dv">27</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>), <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="st">&#39;Disease-conducive </span><span class="ch">\n</span><span class="st"> weather&#39;</span>, <span class="dt">rot=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>), <span class="dt">zlab =</span><span class="kw">list</span>(<span class="st">&#39;Yield loss after 5 seasons (%)&#39;</span>, <span class="dt">rot=</span><span class="dv">90</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>) , <span class="dt">zlim =</span> <span class="kw">range</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>,<span class="dv">20</span>)), <span class="dt">zoom=</span><span class="fl">0.8</span>)

<span class="co">#trellis.device(device=&#39;pdf&#39;,file=&quot;whivarPSlobe20.pdf&quot;, paper=&#39;a4&#39;)</span>
<span class="co">#trellis.par.set(&quot;axis.line&quot;, list(col=&quot;transparent&quot;))</span>
<span class="kw">print</span>(whivarPSlobe20)</code></pre></div>
<p><img src="seedHealth_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#dev.off()</span>

<span class="co">#Low variability in selection, high initial infection (80%) </span>

out.PS14&lt;-<span class="st"> </span><span class="kw">multipar</span>(<span class="dt">pHSinit=</span><span class="fl">0.2</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>), <span class="dt">wxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>,<span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>), <span class="dt">zxtnormsd=</span> <span class="fl">0.1</span>, <span class="dt">gx=</span><span class="dv">4</span>, <span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">5</span>, <span class="dt">nsim=</span>nreals, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>, <span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)

<span class="co">#write.table(x=out.PS14, file=paste(&#39;out.PS14&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span>

xvar &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>out.PS14<span class="op">$</span>zxtnormm
yvar&lt;-<span class="st"> </span>out.PS14<span class="op">$</span>wxtnormm
zvar &lt;-<span class="st"> </span>out.PS14<span class="op">$</span>fYLmean

wlovarPSlobe80&lt;-<span class="st"> </span><span class="kw">wireframe</span>(zvar <span class="op">~</span><span class="st"> </span>xvar <span class="op">*</span><span class="st"> </span>yvar, <span class="dt">data =</span> out.PS14, <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">arrows=</span><span class="ot">FALSE</span>, <span class="dt">cex=</span> <span class="fl">1.25</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">font =</span> <span class="dv">1</span>, <span class="dt">distance=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">z =</span><span class="op">-</span><span class="dv">50</span>, <span class="dt">x =</span> <span class="op">-</span><span class="dv">75</span>), <span class="dt">xlab =</span> <span class="kw">list</span>(<span class="st">&#39;Healthy seeds </span><span class="ch">\n</span><span class="st"> selected&#39;</span>, <span class="dt">rot=</span><span class="op">-</span><span class="dv">27</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>), <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="st">&#39;Disease-conducive </span><span class="ch">\n</span><span class="st"> weather&#39;</span>, <span class="dt">rot=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>), <span class="dt">zlab =</span><span class="kw">list</span>(<span class="st">&#39;Yield loss after 5 seasons (%)&#39;</span>, <span class="dt">rot=</span><span class="dv">90</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>) , <span class="dt">zlim =</span> <span class="kw">range</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>,<span class="dv">20</span>)), <span class="dt">zoom=</span><span class="fl">0.8</span>)

<span class="co">#trellis.device(device=&#39;pdf&#39;,file=&quot;wlovarPSlobe80.pdf&quot;, paper=&#39;a4&#39;)</span>
<span class="co">#trellis.par.set(&quot;axis.line&quot;, list(col=&quot;transparent&quot;))</span>
<span class="kw">print</span>(wlovarPSlobe80)</code></pre></div>
<p><img src="seedHealth_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#dev.off()</span>

<span class="co">#High variability in selection, high initial infection (80%) </span>

out.PS13&lt;-<span class="st"> </span><span class="kw">multipar</span>(<span class="dt">pHSinit=</span><span class="fl">0.2</span>, <span class="dt">Kx =</span> <span class="dv">100</span>, <span class="dt">betax=</span><span class="fl">0.02</span>, <span class="dt">wxtnormm=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>), <span class="dt">wxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">hx=</span><span class="dv">1</span>, <span class="dt">mxtnormm=</span><span class="dv">1</span>,<span class="dt">mxtnormsd=</span><span class="dv">0</span>, <span class="dt">axtnormm=</span><span class="dv">1</span>, <span class="dt">axtnormsd=</span><span class="dv">0</span>, <span class="dt">rx=</span><span class="fl">0.1</span>, <span class="dt">zxtnormm=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>), <span class="dt">zxtnormsd=</span> <span class="fl">0.3</span>, <span class="dt">gx=</span><span class="dv">4</span>, <span class="dt">cx=</span><span class="fl">0.9</span>, <span class="dt">phix=</span><span class="dv">0</span>, <span class="dt">nseasons=</span><span class="dv">5</span>, <span class="dt">nsim=</span>nreals, <span class="dt">HPcut=</span><span class="fl">0.5</span>, <span class="dt">pHScut=</span><span class="fl">0.5</span>,<span class="dt">maY=</span><span class="dv">100</span>,<span class="dt">miY=</span><span class="dv">0</span>, <span class="dt">thetax=</span><span class="fl">0.2</span>, <span class="dt">Ex=</span><span class="dv">0</span>)

<span class="co">#write.table(x=out.PS13, file=paste(&#39;out.PS13&#39;,&#39;csv&#39;, sep=&#39;.&#39;), sep=&#39;,&#39;,append=F, row.names=FALSE)</span>

xvar &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>out.PS13<span class="op">$</span>zxtnormm
yvar&lt;-<span class="st"> </span>out.PS13<span class="op">$</span>wxtnormm
zvar &lt;-<span class="st"> </span>out.PS13<span class="op">$</span>fYLmean

ps13.df&lt;-<span class="kw">data.frame</span>(xvar, yvar, zvar)


whivarPSlobe80&lt;-<span class="kw">wireframe</span>(zvar <span class="op">~</span><span class="st"> </span>xvar <span class="op">*</span><span class="st"> </span>yvar,<span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">arrows=</span><span class="ot">FALSE</span>, <span class="dt">cex=</span> <span class="fl">1.25</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">font =</span> <span class="dv">1</span>, <span class="dt">distance=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">z =</span><span class="op">-</span><span class="dv">50</span>, <span class="dt">x =</span> <span class="op">-</span><span class="dv">75</span>), <span class="dt">xlab =</span> <span class="kw">list</span>(<span class="st">&#39;Healthy seeds </span><span class="ch">\n</span><span class="st"> selected&#39;</span>, <span class="dt">rot=</span><span class="op">-</span><span class="dv">27</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>), <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="st">&#39;Disease-conducive </span><span class="ch">\n</span><span class="st"> weather&#39;</span>, <span class="dt">rot=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>), <span class="dt">zlab =</span><span class="kw">list</span>(<span class="st">&#39;Yield loss after 5 seasons (%)&#39;</span>, <span class="dt">rot=</span><span class="dv">90</span>, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="dt">font=</span><span class="dv">2</span>) , <span class="dt">zlim =</span> <span class="kw">range</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>,<span class="dv">20</span>)), <span class="dt">zoom=</span><span class="fl">0.8</span>)

<span class="kw">print</span>(whivarPSlobe80)</code></pre></div>
<p><img src="seedHealth_files/figure-html/unnamed-chunk-4-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

<span class="kw">ggplot</span>(ps13.df, <span class="kw">aes</span>(xvar, yvar, <span class="dt">fill=</span>zvar))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>()<span class="op">+</span>
<span class="st">  </span>viridis<span class="op">::</span><span class="kw">scale_fill_viridis</span>(<span class="dt">option =</span> <span class="st">&quot;C&quot;</span>, 
                              <span class="dt">guide =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="st">&quot;Yield Loss After 5 Seasons (%)&quot;</span>, 
                                                     <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>,
                                                     <span class="dt">direction=</span><span class="st">&quot;horizontal&quot;</span>,
                                                     <span class="dt">barwidth =</span> <span class="dv">20</span>, 
                                                     <span class="dt">barheight =</span> <span class="dv">2</span>,
                                                     <span class="dt">frame.colour =</span> <span class="st">&quot;black&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Healthy Seeds Selected&#39;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Disease-Conducive Weather&#39;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,
        <span class="dt">legend.title.align=</span><span class="fl">0.5</span>,
        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, 
                                  <span class="dt">size =</span> <span class="dv">20</span>),
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>,
                                    <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),
        <span class="co">#legend.background = element_blank(),</span>
        <span class="co">#legend.box.background = element_blank(),</span>
        <span class="co">#panel.grid.major = element_blank(), </span>
        <span class="co">#panel.grid.minor = element_blank(),</span>
        <span class="co">#panel.background = element_rect(fill = &quot;transparent&quot;,colour = NA),</span>
        <span class="co">#plot.background = element_rect(fill = &quot;transparent&quot;,colour = NA)</span>
        )</code></pre></div>
<p><img src="seedHealth_files/figure-html/unnamed-chunk-4-5.png" width="672" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
